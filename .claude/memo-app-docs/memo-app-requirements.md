# メモアプリ要件定義書

## 1. プロジェクト概要

### 1.1 目的・背景
**プロジェクト名**: 音声メモアプリ  
**対象ユーザー**: 個人利用者（会議、アイデア記録、日常メモ用途）  
**主要価値**: 音声録音と自動文字起こしによる効率的なメモ作成・管理  
**コンセプト**: 「ひらめきをパッと保存、パッと検索」

### 1.2 ターゲットユーザー
- **基本利用**: 個人利用メイン
- **グループ利用**: 最大10人程度の小グループ
- **利用シーン**: 会議、アイデア記録、日常メモ、外出先での記録
- **現在の課題**: Obsidian使用中だが音声録音・ショートカットアクセスが困難

### 1.3 期待効果・成功指標
- 過去情報への瞬時アクセス（アクセシビリティ向上）
- 思いついた情報を100%逃さず記録
- 検索時間の大幅短縮
- 1日10回以上の高頻度利用に対応

## 2. 機能要件

### 2.1 MVP機能一覧（全て必須）
1. **音声録音機能** - ワンタップで録音開始/停止
2. **自動文字起こし** - OpenAI Whisper APIによる高精度変換
3. **メモ保存・管理** - Firebaseでの永続化
4. **タイムライン表示** - LINE風UIでの時系列表示
5. **テキスト入力** - 手動メモ入力機能

### 2.2 主要ユーザーフロー
1. アプリ起動 → タイムライン表示
2. 🎤ボタンタップ → 録音モーダル表示
3. 音声録音 → 任意のタイミングで停止
4. 文字起こし処理 → 保存完了通知
5. タイムラインに新規メモ表示

### 2.3 画面構成
- **メイン画面**: LINE風タイムライン + 下部入力エリア
- **録音画面**: フルスクリーンモーダル（音声録音+文字起こし）
- **設定画面**: 文字起こしリトライ回数設定等

## 3. 詳細機能仕様（Phase 3確定内容）

### 3.1 音声録音機能
- **録音時間**: 任意時間（手動停止）、デフォルト30秒、最大1分
- **音質設定**: アプリ側で自動最適化（ユーザー設定不要）
- **エラー処理**: マイク許可拒否時「マイクを許可してください」メッセージ表示
- **UI**: フルスクリーンモーダル、波形アニメーション、経過時間表示

### 3.2 文字起こし機能
- **処理時間**: 10秒以内を目標
- **リトライ**: 設定可能（デフォルト2回）、1-5回の範囲で設定
- **失敗時**: 音声ファイルのみ保存（後でリトライ可能）
- **API**: OpenAI Whisper API使用

### 3.3 データ保存機能
- **保存内容**: 音声ファイル + 文字起こしテキスト + 録音日時
- **容量制限**: 1ファイル5MB上限
- **保存先**: Firebase Storage + Firestore
- **通知**: PSトロフィー風スライドポップアップ

### 3.4 タイムライン表示機能
- **表示方式**: 無限スクロール
- **読み込み**: 初期50件、追加50件ずつ取得
- **並び順**: 日付降順（最新が上）
- **グループ化**: 日付別セクション（Today, Yesterday, 日付）

### 3.5 テキスト入力機能
- **文字数制限**: なし（自由入力）
- **入力方式**: 下部テキストエリア + 送信ボタン
- **保存**: 即座にFirestoreに保存

## 4. 非機能要件（Phase 4確定内容）

### 4.1 パフォーマンス要件
- **利用者数**: 基本1人、グループ最大10人
- **応答時間**: 録音開始は即座、文字起こしは10秒以内
- **データ量**: 1日複数回の利用を想定

### 4.2 セキュリティ要件
- **認証方法**: メールアドレス+パスワード、Googleアカウント対応
- **アクセス制御**: ユーザー別データ分離
- **データ保護**: Firebase Security Rules適用

### 4.3 可用性・信頼性要件
- **稼働時間**: ベストエフォート（基本稼働、たまにメンテOK）
- **バックアップ**: Firebase標準機能利用
- **データ保持**: 削除機能提供、基本的には永続保存

### 4.4 運用・保守性要件
- **運用体制**: 個人開発・運用
- **メンテナンス**: 事前告知の上で実施
- **監視**: Firebase標準監視機能利用

## 5. 制約・前提条件

### 5.1 技術制約
- **開発環境**: 開発中はFirebase無料枠内
- **技術スタック**: React 19 + TypeScript + Firebase
- **UI Framework**: カスタムコンポーネント + Tailwind CSS + CSS Modules
- **アニメーション**: Framer Motion
- **外部API**: OpenAI Whisper API利用
- **Material-UI削除**: カスタムコンポーネントで代替

### 5.2 ビジネス制約
- **コスト**: 開発中は無料範囲内で実現
- **スケジュール**: 段階的開発（Phase 1→2→3）
- **リソース**: 個人開発

### 5.3 デバイス制約
- **対象**: Webアプリケーション（PWA対応予定）
- **ブラウザ**: モダンブラウザ対応
- **レスポンシブ**: モバイルファースト設計

## 6. データ要件

### 6.1 データ種別
- **音声データ**: WAV/MP3形式、最大5MB
- **テキストデータ**: 文字起こし結果、手動入力テキスト
- **メタデータ**: 作成日時、ユーザーID、タイトル

### 6.2 データ関係
- **ユーザー**: 1対多でメモを所有
- **メモ**: 音声ファイル、テキスト、メタデータを含む
- **グループ**: 将来的にメモ共有機能想定

### 6.3 データライフサイクル
- **作成**: 録音終了時またはテキスト送信時
- **更新**: 文字起こし完了時、手動編集時
- **削除**: ユーザー操作による削除

## 7. 外部連携

### 7.1 外部システム連携
- **Firebase**: 認証、データベース、ストレージ
- **OpenAI**: Whisper API（音声→テキスト変換）

### 7.2 API要件
- **Firebase SDK**: Web SDK利用
- **OpenAI API**: REST API呼び出し
- **Web Audio API**: ブラウザ標準API利用

### 7.3 第三者サービス利用
- **Firebase**: Google提供のBaaS
- **OpenAI**: 音声認識サービス
- **Vercel**: ホスティング・デプロイ

## 8. UI/UX設計

### 8.1 デザインコンセプト（v2.0 LINE風紫系UI）
- **LINE風チャットUI**: 親しみやすいメッセージング体験
- **紫系統のモダンデザイン**: 青紫〜純パープルのグラデーション
- **没入感**: フルスクリーンモーダルで録音に集中
- **達成感**: トロフィー風通知でユーザー体験向上
- **自分との対話**: アイデアを整理し記録する個人的な空間

### 8.2 カラーパレット（3色ルール適用）

#### ベースカラー（70%使用）
- **メイン背景**: #FFFFFF
- **セカンダリ背景**: #F9FAFB  
- **カード・入力エリア背景**: #F3F4F6
- **ボーダー・区切り線**: #E5E7EB

#### メインカラー（25%使用）- 紫系グラデーション
- **メインパープル**: #7C3AED
- **青紫（グラデーション用）**: #6366F1
- **薄紫（自分のメッセージバブル）**: #C4B5FD
- **濃紫（アクティブ状態）**: #5B21B6

#### アクセントカラー（5%使用）
- **ピンク紫（重要なアクション）**: #EC4899
- **アンバー（警告・注意）**: #F59E0B
- **エメラルド（成功・完了）**: #10B981
- **レッド（エラー・削除）**: #EF4444

#### ダークモード
- **ダーク背景**: #1F2937, #111827, #374151
- **ダークボーダー**: #4B5563

### 8.3 メッセージバブル仕様（LINE風）

#### 自分のメッセージ（右寄せ）
- **配置**: 右寄せ、最大幅70%
- **背景**: 紫グラデーション（#7C3AED → #6366F1）
- **文字色**: 白
- **角丸**: 18px（左下のみ4px）
- **シャドウ**: 紫系統のぼかし

#### システムメッセージ（文字起こし結果等）
- **配置**: 左寄せ、最大幅70%
- **背景**: #F3F4F6（グレー）
- **文字色**: #374151
- **角丸**: 18px（右下のみ4px）

#### 音声メッセージ
- **アイコン**: 🎤（メッセージ内左端）
- **波形表示**: 簡略化されたオーディオ波形
- **再生時間**: 右下に表示（例："0:30"）
- **再生ボタン**: ▶️/⏸️ トグル

### 8.4 画面設計（LINE風レイアウト）

#### メイン画面構成
```
┌─────────────────────────────────┐
│ 📝 VoiceMemo          🔍 🌙 ⚙️  │ ← ヘッダー（固定60px）
├─────────────────────────────────┤
│                                 │
│  ── Today ──                    │ ← 日付区切り
│                                 │
│              ┌─────────────┐    │
│              │ こんにちは！ │    │ ← 自分のメモ（右寄せ）
│              │ 会議の内容を │    │    紫グラデーション
│              │ メモします   │    │
│              └─────────────┘    │
│                     14:30       │
│                                 │
│ ┌─────────────────┐             │
│ │ 📄 文字起こし   │             │ ← システムメッセージ
│ │ 完了しました    │             │    （左寄せ・グレー）
│ └─────────────────┘             │
│        14:31                    │
│                                 │
│              ┌─────────────┐    │
│              │ 🎤 0:30     │    │ ← 音声メモ（右寄せ）
│              │ ━━━━━━━━   │    │
│              │    ▶️       │    │
│              └─────────────┘    │
│                     14:32       │
│                                 │
├─────────────────────────────────┤
│ 📝 メッセージを入力... 🎤 📤     │ ← 入力エリア（固定80px）
└─────────────────────────────────┘
```

#### 録音モーダル（フルスクリーン）
```
┌─────────────────────────────────┐
│                                 │
│         音声録音中              │
│                                 │
│      ◐ ◐ ◐ ◐ ◐ ◐ ◐          │ ← 波形アニメーション
│                                 │    （紫グラデーション）
│         00:15 / 01:00           │ ← 経過時間/最大時間
│                                 │
│     [■ 停止]    [✓ 完了]       │ ← アクションボタン
│                                 │
└─────────────────────────────────┘
```

#### 文字起こしモーダル
```
┌─────────────────────────────────┐
│                                 │
│      文字起こし処理中...        │
│                                 │
│    ████████████░░░░░░░         │ ← プログレスバー
│                                 │    （紫グラデーション）
│    音声を解析しています         │
│                                 │
└─────────────────────────────────┘
```

### 8.5 アニメーション・インタラクション

#### メッセージ送信アニメーション
1. **入力エリアから上昇**: translateY(40px) → translateY(0)
2. **透明度変化**: opacity: 0 → opacity: 1  
3. **バウンス効果**: scale(0.95) → scale(1.02) → scale(1)
4. **継続時間**: 300ms, ease-out

#### 音声録音中アニメーション
- **パルス効果**: ボタンの拡大縮小 + 外側への波紋
- **色**: ピンク紫（#EC4899）のグロー効果

#### 通知（トロフィー風）
- **スライド**: 画面右端から左へスライドイン
- **背景**: 紫グラデーション（#7C3AED → #EC4899）
- **継続時間**: 3秒間表示後、自動フェードアウト

### 8.6 レスポンシブデザイン

#### ブレークポイント
- **モバイル（〜640px）**: メッセージバブル最大85%、ヘッダー56px
- **タブレット（641px〜1024px）**: メッセージバブル最大75%、コンテナ768px
- **デスクトップ（1025px〜）**: コンテナ最大800px、中央配置

#### モバイル最適化
- **タッチターゲット**: 最小 44px × 44px
- **スワイプジェスチャー**: 左スワイプでメッセージアクション
- **長押し**: メッセージのコピー・共有メニュー

### 8.7 アクセシビリティ（WCAG 2.1 AA準拠）

#### キーボードナビゲーション
- **Tab順序**: 検索 → メッセージ → 入力 → 音声 → 送信
- **Enterキー**: 送信（Shift+Enterで改行）
- **Escapeキー**: 録音中止、モーダル閉じる

#### スクリーンリーダー対応
- **音声メッセージ**: aria-label="音声メッセージ、30秒、午後2時15分"
- **テキストメッセージ**: aria-label="テキストメッセージ、午後2時15分"

#### 色彩・コントラスト
- **最小コントラスト比**: 4.5:1（通常テキスト）
- **大きなテキスト**: 3:1（18px以上）
- **色に依存しない情報伝達**: アイコン・形状も併用

## 9. 将来拡張性

### 9.1 Phase 2機能
- **自動タグ付け**: AI による内容理解・分類
- **高度な検索**: キーワード・タグ・日付・自然言語・曖昧検索

### 9.2 Phase 3機能
- **議事録アップロード**: ファイルアップロード対応
- **UI改善**: 追加のユーザビリティ向上

### 9.3 将来機能
- **Apple Watch対応**: 録音特化機能
- **家族共有**: グループでのメモ共有
- **エクスポート**: 月1回自動 + 手動エクスポート

## 10. 開発方針

### 10.1 開発段階
- **Phase 1**: 基本UI + 音声録音 + 文字起こし
- **Phase 2**: 自動タグ付け + 検索機能
- **Phase 3**: 議事録アップロード + 最終調整

### 10.2 品質保証
- **要件の整合性**: 機能間の矛盾なし
- **完全性**: 必要な要件の網羅
- **明確性**: 曖昧な表現の排除
- **実現可能性**: 技術制約のクリア
- **テスタビリティ**: 受け入れ基準の明確化

---

**文書作成日**: 2025年8月3日  
**最終更新**: Phase 1-4 要件定義完了（v2.0 LINE風紫系UI対応）  
**改版履歴**:  
- v2.0 (2024-08-10): LINE風紫系UIへ全面刷新、Material-UI削除、カスタムコンポーネント採用
- v1.0 (2024-08-03): 初版作成  
**次ステップ**: 詳細設計 → UI実装開始